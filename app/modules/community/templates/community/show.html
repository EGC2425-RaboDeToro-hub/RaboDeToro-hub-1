{% extends "base_template.html" %}

{% block title %}{{ community.name }}{% endblock %}

{% block content %}
<div class="col-12 col-md-8 col-lg-6"> 

    <div class="card shadow-sm" > 
        <div class="card-header card-dark"> 
            <h5 class="card-title mb-0" style="color: white; font-size: 15px;">{{ community.name }}</h5>
        </div>
        <div class="card-body">
            <p class="card-text h5"><i class="fa fa-user-circle"></i>{{community.description}}</p>
            <p class="card-text h5"><i class="fa fa-id-card"></i> <strong>Users:</strong> {{usersSize}} users</p>
            <p class="card-text h5"><i class="fa fa-database"></i> <strong>Datasets:</strong> {{ datasetsSize }} datasets</p>
            <div style="flex: 1; margin-right: 20px;">
                <a href="{{ url_for('community.update_community', community_id=community.id) }}"><button>Editar</button></a>
            </div>
            <div class="mt-3">
                <form method="POST" action="{{ url_for('community.delete_community', community_id=community.id) }}">
                    <button type="submit">Eliminar</button>
                </form>
            </div>
        </div>   
    </div>
</div>

{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        <ul class="flashes">
        {% for category, message in messages %}
            <li class="{{ category }}">{{ message }}</li>
        {% endfor %}
        </ul>
    {% endif %}
{% endwith %}

<div class="container">
    <div class="row">
        <div class="col-md-6">
            <h3>Datasets</h3>
            <hr>
            {% if datasets %}
                <div class="card">
                    <div class="card-body">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Options</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for dataset in datasets %}
                                    <tr>
                                        <td>{{ dataset.name }}</td>
                                        <td>
                                            <!-- Aquí puedes agregar opciones como ver, editar, eliminar, etc. -->
                                            <a href="{{ url_for('dataset.view', dataset_id=dataset.id) }}">View</a>
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            {% else %}
                <p>No hay datasets disponibles.</p>
            {% endif %}
        </div>

        <!-- Sección de usuarios a la derecha -->
        <div class="col-md-6">
            <h3>Usuarios</h3>
            <hr>
            <ul>
                {% if not users[current_user] %}
                    {% for user in users %}
                    <li>
                        {% if users[user] %}
                            <span>{{ user }} (admin) </span>
                        {% else %}
                            {{ user }}
                        {% endif %}
                    </li>
                    {% endfor %}
                {% else %}
                    {% for user in users %}
                    <li>
                        {% if users[user] %}
                            <span>{{ user }} (admin) </span>
                        {% else %}
                            <span>{{ user }} </span>
                        {% endif %}
                    </li>
                    {% endfor %}
                {% endif %}
            </ul>
        </div>
    </div>
</div>
{% endblock %}